<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>初识 MongoDB | QiJieH&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/blog/web-img/author.jpg">
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="/blog/js/MouseClickEffect.js"></script>
    <script src="/blog/js/HeroVideo.js"></script>
    <meta name="description" content="Blog HTML CSS C++ C Java Python DataBase MySQL Vuepress FrontEnd technology">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/blog/assets/css/0.styles.1b343ea6.css" as="style"><link rel="preload" href="/blog/assets/js/app.7616911d.js" as="script"><link rel="preload" href="/blog/assets/js/4.1133f83b.js" as="script"><link rel="preload" href="/blog/assets/js/1.f2954d1d.js" as="script"><link rel="preload" href="/blog/assets/js/15.7d37d9db.js" as="script"><link rel="preload" href="/blog/assets/js/9.cb224565.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.7b9556f6.js"><link rel="prefetch" href="/blog/assets/js/11.f7f1505b.js"><link rel="prefetch" href="/blog/assets/js/12.cb78b0b1.js"><link rel="prefetch" href="/blog/assets/js/13.18f97aeb.js"><link rel="prefetch" href="/blog/assets/js/14.91f2232c.js"><link rel="prefetch" href="/blog/assets/js/16.f6318e6a.js"><link rel="prefetch" href="/blog/assets/js/17.8b2835ac.js"><link rel="prefetch" href="/blog/assets/js/18.fa00cd8e.js"><link rel="prefetch" href="/blog/assets/js/19.08dc8d66.js"><link rel="prefetch" href="/blog/assets/js/20.41832391.js"><link rel="prefetch" href="/blog/assets/js/21.c89933a1.js"><link rel="prefetch" href="/blog/assets/js/22.1fa0af37.js"><link rel="prefetch" href="/blog/assets/js/23.b0ab335e.js"><link rel="prefetch" href="/blog/assets/js/24.6e5e201f.js"><link rel="prefetch" href="/blog/assets/js/25.63f52fa6.js"><link rel="prefetch" href="/blog/assets/js/26.12165fbe.js"><link rel="prefetch" href="/blog/assets/js/27.89d1796e.js"><link rel="prefetch" href="/blog/assets/js/28.34c8b2e6.js"><link rel="prefetch" href="/blog/assets/js/29.e018bd18.js"><link rel="prefetch" href="/blog/assets/js/30.a1c99d7c.js"><link rel="prefetch" href="/blog/assets/js/31.d47b010b.js"><link rel="prefetch" href="/blog/assets/js/32.151c8814.js"><link rel="prefetch" href="/blog/assets/js/5.dd4680f3.js"><link rel="prefetch" href="/blog/assets/js/6.22dfcefc.js"><link rel="prefetch" href="/blog/assets/js/7.613eb78c.js"><link rel="prefetch" href="/blog/assets/js/8.a6d16518.js"><link rel="prefetch" href="/blog/assets/js/vendors~flowchart.d9532bba.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.1b343ea6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-dad8a512><div data-v-dad8a512><LoadingPage class="loading-wrapper" data-v-dad8a512 data-v-dad8a512></LoadingPage> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>QiJieH's Blog</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>QiJieH</span>
            
          <!---->
          2020
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/web-img/author.jpg" alt="QiJieH's Blog" class="logo"> <span class="site-name">QiJieH's Blog</span></a> <div class="links"><!----> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><img src="/blog/web-img/author.jpg" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    QiJieH
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>19</h3> <h6 data-v-ca798c94>Article</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>21</h3> <h6 data-v-ca798c94>Tag</h6></div></div> <hr data-v-ca798c94></div> <!----> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>初识 MongoDB</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>QiJieH</span>
            
          <!---->
          2020
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>初识 MongoDB</h1> <hr> <div data-v-aa64b9d0><i class="iconfont reco-account" data-v-aa64b9d0><span data-v-aa64b9d0>QiJieH</span></i> <i class="iconfont reco-date" data-v-aa64b9d0><span data-v-aa64b9d0>2020-08-07</span></i> <!----> <i class="iconfont reco-tag tags" data-v-aa64b9d0><span class="tag-item" data-v-aa64b9d0>MongoDB</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><div class="custom-block tip"><p>MongoDB 是一个基于分布式文件存储非关系数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。<br>
官方文档：<a href="https://docs.mongodb.com/guides/" target="_blank" rel="noopener noreferrer">MongoDB Doc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <h1 id="mongodb-基础语法"><a href="#mongodb-基础语法" class="header-anchor">#</a> MongoDB 基础语法</h1> <p>官方文档：<a href="https://docs.mongodb.com/guides/" target="_blank" rel="noopener noreferrer">Getting Started<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。</p> <p>MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</p> <h2 id="数据结构"><a href="#数据结构" class="header-anchor">#</a> 数据结构</h2> <p>MongDB 所有的数据都是以 json 对象进行存储的</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
 <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;notebook&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;qty&quot;</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
 <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> <span class="token property">&quot;score&quot;</span><span class="token operator">:</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">&quot;score&quot;</span><span class="token operator">:</span> <span class="token number">9</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;height&quot;</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token property">&quot;width&quot;</span><span class="token operator">:</span> <span class="token number">8.5</span><span class="token punctuation">,</span> <span class="token property">&quot;unit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;in&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;college-ruled&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;perforated&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在进行数据库结构设计时务必参照 JSON 标准。</p> <p>MongoDB术语 参照 SQL术语 理解</p> <table><thead><tr><th style="text-align:left;">SQL术语/概念</th> <th style="text-align:left;">MongoDB术语/概念</th> <th style="text-align:left;">解释/说明</th></tr></thead> <tbody><tr><td style="text-align:left;">database</td> <td style="text-align:left;">database</td> <td style="text-align:left;">数据库</td></tr> <tr><td style="text-align:left;">table</td> <td style="text-align:left;">collection</td> <td style="text-align:left;">数据库表/集合</td></tr> <tr><td style="text-align:left;">row</td> <td style="text-align:left;">document</td> <td style="text-align:left;">数据记录行/文档</td></tr> <tr><td style="text-align:left;">column</td> <td style="text-align:left;">field</td> <td style="text-align:left;">数据字段/域</td></tr> <tr><td style="text-align:left;">index</td> <td style="text-align:left;">index</td> <td style="text-align:left;">索引</td></tr> <tr><td style="text-align:left;">table joins</td> <td style="text-align:left;"></td> <td style="text-align:left;">表连接,MongoDB不支持</td></tr> <tr><td style="text-align:left;">primary key</td> <td style="text-align:left;">primary key</td> <td style="text-align:left;">主键,MongoDB自动将_id字段设置为主键</td></tr></tbody></table> <h2 id="安装部署"><a href="#安装部署" class="header-anchor">#</a> 安装部署</h2> <p>下载中心</p> <p><a href="https://www.mongodb.com/download-center#production" target="_blank" rel="noopener noreferrer">MongoDB Download Center<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>mongodb 社区版下载</p> <p><a href="https://www.mongodb.com/try/download/community" target="_blank" rel="noopener noreferrer">MongoDB Community<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>mongodb 图形界面管理工具（可选）</p> <p><a href="https://www.mongodb.com/try/download/compass" target="_blank" rel="noopener noreferrer">MongoDB Compass<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="使用引导安装"><a href="#使用引导安装" class="header-anchor">#</a> 使用引导安装</h3> <p>在命令行操作 mongodb 时请务必使用<strong>管理员权限打开命令行窗口</strong></p> <p>所有的安装设置都会在引导界面设置完成，之后通过命令行操作数据库服务</p> <ul><li>启动服务</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code>net <span class="token function">start</span> mongodb
</code></pre></div><ul><li>停止服务</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code>net stop mongodb
</code></pre></div><ul><li>移除服务</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code>C:\Program Files\MongoDB\Server\4<span class="token punctuation">.</span>2\bin\mongo<span class="token punctuation">.</span>exe <span class="token operator">--</span>remove
</code></pre></div><ul><li>连接管理</li></ul> <div class="language-powershell extra-class"><pre class="language-powershell"><code>C:\Program Files\MongoDB\Server\4<span class="token punctuation">.</span>2\bin\mongo<span class="token punctuation">.</span>exe
</code></pre></div><h3 id="使用命令行安装"><a href="#使用命令行安装" class="header-anchor">#</a> 使用命令行安装</h3> <p>移除服务后需要手动以命令行方式进行安装</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>mongod <span class="token operator">--</span>logpath=<span class="token string">&quot;C:\Program Files\MongoDB\Server\4.2\log\mongod.log&quot;</span> <span class="token operator">--</span>dbpath=<span class="token string">&quot;C:\Program Files\MongoDB\Server\4.2\data&quot;</span> <span class="token operator">--</span>install
</code></pre></div><h3 id="添加系统变量"><a href="#添加系统变量" class="header-anchor">#</a> 添加系统变量</h3> <p>虽然这步不是必须的，但是在使用 mongodb 过程中某些命令需要系统变量的支持。</p> <p>MongoDB安装目录下的bin路径导入到系统变量Path中。</p> <h3 id="设置身份验证"><a href="#设置身份验证" class="header-anchor">#</a> 设置身份验证</h3> <p>初次安装时是没有设置身份验证的，任何人都可以访问你的数据库，这样是十分危险的。接下来将为 mongodb 部署强制身份验证。</p> <p>在命令行窗口运行以下命令，确保 mongodb 服务在你的系统上存在</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>tasklist <span class="token operator">/</span>FI <span class="token string">&quot;IMAGENAME eq mongod.exe&quot;</span>
</code></pre></div><p>如果显示以下字段，说明 mogodb 服务正在运行</p> <div class="language- extra-class"><pre class="language-text"><code>Image Name                     PID Session Name        Session#    Mem Usage
========================= ======== ================ =========== ============
mongod.exe                    8716 Console                    1      9,508 K
</code></pre></div><ol><li>使用命令行打开运行 mongo.exe</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>C:\Program Files\MongoDB\Server\4<span class="token punctuation">.</span>2\bin\mongo<span class="token punctuation">.</span>exe
</code></pre></div><ol start="2"><li>切换到 admin 数据库</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>use admin
</code></pre></div><ol start="3"><li>新建超级管理员账户</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    user: <span class="token string">&quot;superuser&quot;</span><span class="token punctuation">,</span>
    <span class="token function">pwd</span>: <span class="token string">&quot;changeMeToAStrongPassword&quot;</span><span class="token punctuation">,</span>
    roles: <span class="token punctuation">[</span> <span class="token string">&quot;root&quot;</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><ol start="5"><li>验证是否创建成功</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>show users
</code></pre></div><ol start="6"><li>卸载 mongodb 服务</li></ol> <div class="language- extra-class"><pre class="language-text"><code>net stop mongodb
mongod --remove
</code></pre></div><ol start="7"><li>创建 mongodb 服务 注意 -auth 参数</li></ol> <div class="language- extra-class"><pre class="language-text"><code>mongod --logpath=&quot;C:\Program Files\MongoDB\Server\4.2\log\mongod.log&quot; --dbpath=&quot;C:\Program Files\MongoDB\Server\4.2\data&quot; --install -auth
</code></pre></div><p>如果您已成功完成本指南，则已在本地 MongoDB 实例上启用了基本身份验证。</p> <h3 id="添加数据库用户"><a href="#添加数据库用户" class="header-anchor">#</a> 添加数据库用户</h3> <p>在添加数据库用户之前您必须拥有超级管理员账号。</p> <p>连接到数据库 admin 进行身份验证，之后切换到需要创建管理账户的数据库中使用 <code>db.createUser</code> 进行创建。</p> <div class="language- extra-class"><pre class="language-text"><code>mongo.exe
use admin
db.auth(&quot;rootname&quot;,&quot;rootpwd&quot;)
use dba
db.createUser({
	user:&quot;dbaadmin&quot;,
	pwd:&quot;admin&quot;,
	roles:[&quot;readWrite&quot;]
})
</code></pre></div><blockquote><p>注意只有切换到响应的数据库之后才能进行身份验证或用户创建，否则会出现验证失败和创建失败。</p></blockquote> <h2 id="连接数据库"><a href="#连接数据库" class="header-anchor">#</a> 连接数据库</h2> <h3 id="未启用身份验证"><a href="#未启用身份验证" class="header-anchor">#</a> 未启用身份验证</h3> <p>如果你未启用身份验证，您可以容易的使用命令行进入数据库</p> <div class="language- extra-class"><pre class="language-text"><code>C:\Program Files\MongoDB\Server\4.2\bin\mongo.exe
</code></pre></div><p>在 Compass 中只需要点击 connect 即可，无需配置</p> <h3 id="启用身份验证"><a href="#启用身份验证" class="header-anchor">#</a> 启用身份验证</h3> <p>如果你启用了身份验证，在使用 Compass 连接时需要填写 URL ，url的填写规则为</p> <div class="language- extra-class"><pre class="language-text"><code>mongodb:身份名:身份密码@host:port/数据库名称

mongodb:root:root@localhost:27017/admin
</code></pre></div><p>在命令行中启动 mongo.exe 切换到正确数据库之后使用 <code>db.auth(&quot;name&quot;,&quot;pwd&quot;)</code> 来进行验证</p> <div class="language- extra-class"><pre class="language-text"><code>mongo.exe
use admin
db.auth(&quot;root&quot;,&quot;root&quot;)
</code></pre></div><blockquote><p>命令行进入 mongo.exe 并不需要验证，但是这样是无法查看或修改任何数据的</p></blockquote> <h3 id="api"><a href="#api" class="header-anchor">#</a> API</h3> <p>你可以访问 <a href="https://docs.mongodb.com/drivers/" target="_blank" rel="noopener noreferrer">MongoDB Drivers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来获取您语言操作数据库的 API</p> <p>本文档只介绍 Node.js 对 Mongodb 的连接操作。</p> <p>在 node.js 下操作 mongodb 您需要使用到第三方模块 mongoose 您可以通过 npm 管理工具进行下载</p> <div class="language- extra-class"><pre class="language-text"><code>npm install mongoose
</code></pre></div><p>之后您可以在 js 文件中引入 mongoose 并使用它来连接数据库。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span> <span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>&quot;mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>username<span class="token operator">:</span>userpwd@host<span class="token operator">:</span>port<span class="token operator">/</span>dbname
                    <span class="token punctuation">{</span> useNewUrlParser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> useUnifiedTopology<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接成功'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接失败'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="数据库操作"><a href="#数据库操作" class="header-anchor">#</a> 数据库操作</h2> <p>访问 <a href="https://docs.mongodb.com/drivers/" target="_blank" rel="noopener noreferrer">MongoDB Drivers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来获取您语言操作数据库的 API ，下面我们只介绍使用 mongo.exe 命令行对数据库的操作。</p> <h3 id="创建数据库"><a href="#创建数据库" class="header-anchor">#</a> 创建数据库</h3> <p>MongoDB 创建数据库的语法格式如下：</p> <div class="language- extra-class"><pre class="language-text"><code>use DataBaseName
</code></pre></div><p>这个方法在没有该数据库时会创建该数据库，否则会转到该数据库，注意，如果创建数据库时没有添加该数据库内容，是不会显示该数据库的。</p> <p>如果你想查看所有数据库，可以使用 <strong>show dbs</strong> 命令：</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; show dbs
admin   0.000GB
config  0.000GB
local   0.000GB
&gt; 
</code></pre></div><h3 id="删除数据库"><a href="#删除数据库" class="header-anchor">#</a> 删除数据库</h3> <p>MongoDB 删除数据库的语法格式如下：</p> <div class="language- extra-class"><pre class="language-text"><code>db.dropDatabase()
</code></pre></div><p>您需要使用 use dbname 来切换到需要删除的数据库才能执行删除操作。</p> <h3 id="创建集合"><a href="#创建集合" class="header-anchor">#</a> 创建集合</h3> <div class="language- extra-class"><pre class="language-text"><code>db.createCollection(name, options)

// name ：集合命名  options：集合规则

db.createCollection(&quot;mycol&quot;, 
{ 
	capped : true, 
	autoIndexId : true,
	size : 6142800, 
	max : 10000 
})
</code></pre></div><p>如果要查看已有集合，可以使用 <strong>show collections</strong> 或 <strong>show tables</strong> 命令：</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; show collections
</code></pre></div><h3 id="删除集合"><a href="#删除集合" class="header-anchor">#</a> 删除集合</h3> <div class="language- extra-class"><pre class="language-text"><code>db.collection.drop()

collection 为集合名称 ， 如果要查看已有集合，可以使用 show collections 或 show tables 命令
</code></pre></div><h3 id="插入文档"><a href="#插入文档" class="header-anchor">#</a> 插入文档</h3> <div class="language-powershell extra-class"><pre class="language-powershell"><code>&gt;db<span class="token punctuation">.</span>COLLECTION_NAME<span class="token punctuation">.</span>insertOne<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'json'</span>:<span class="token string">'json'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

db<span class="token punctuation">.</span>COLLECTION_NAME<span class="token punctuation">.</span>insertMany<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'json'</span>:<span class="token string">'json'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>以上代码会将花括号内的 json 对象插入到 col 集合中，如果集合不存在数据库会自动创建。</p> <h3 id="导入文档"><a href="#导入文档" class="header-anchor">#</a> 导入文档</h3> <p><code>mongoimport -d 数据库名称 -c 集合名称 -file 导入目标文件</code></p> <p>使用mongoimport命令需要将MongoDB安装目录下的bin路径导入到系统变量Path中</p> <h3 id="更新文档"><a href="#更新文档" class="header-anchor">#</a> 更新文档</h3> <div class="language- extra-class"><pre class="language-text"><code>&gt;db.COLLECTION_NAME.updateOne({'json':'value'},{$set:{'new key':'new value'}})

&gt;db.COLLECTION_NAME.updateMany({'json':'value'},{$set:{'new key':'new value'}})
</code></pre></div><h3 id="删除文档"><a href="#删除文档" class="header-anchor">#</a> 删除文档</h3> <div class="language- extra-class"><pre class="language-text"><code>// 删除匹配的第一条数据
&gt;db.COLLECTION_NAME.deleteOne({'title':'MongoDB 笔记'})

// 删除所以匹配的数据
&gt;db.COLLECTION_NAME.deleteMany({'title':'MongoDB 笔记'})

// 删除全部
&gt;db.COLLECTION_NAME.deleteMany({})

</code></pre></div><h3 id="查询文档"><a href="#查询文档" class="header-anchor">#</a> 查询文档</h3> <div class="language- extra-class"><pre class="language-text"><code>&gt;db.COLLECTION_NAME.find({key1:value1, key2:value2}).pretty()
// .pretty() 以易读的方式返回查询数据
</code></pre></div></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/14/2020, 5:25:56 AM</span></div></footer> <!----> <!----> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-40a3448a><li class="level-2" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#数据结构" class="sidebar-link" data-v-40a3448a>数据结构</a></li><li class="level-2" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#安装部署" class="sidebar-link" data-v-40a3448a>安装部署</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#使用引导安装" class="sidebar-link" data-v-40a3448a>使用引导安装</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#使用命令行安装" class="sidebar-link" data-v-40a3448a>使用命令行安装</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#添加系统变量" class="sidebar-link" data-v-40a3448a>添加系统变量</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#设置身份验证" class="sidebar-link" data-v-40a3448a>设置身份验证</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#添加数据库用户" class="sidebar-link" data-v-40a3448a>添加数据库用户</a></li><li class="level-2" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#连接数据库" class="sidebar-link" data-v-40a3448a>连接数据库</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#未启用身份验证" class="sidebar-link" data-v-40a3448a>未启用身份验证</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#启用身份验证" class="sidebar-link" data-v-40a3448a>启用身份验证</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#api" class="sidebar-link" data-v-40a3448a>API</a></li><li class="level-2" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#数据库操作" class="sidebar-link" data-v-40a3448a>数据库操作</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#创建数据库" class="sidebar-link" data-v-40a3448a>创建数据库</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#删除数据库" class="sidebar-link" data-v-40a3448a>删除数据库</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#创建集合" class="sidebar-link" data-v-40a3448a>创建集合</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#删除集合" class="sidebar-link" data-v-40a3448a>删除集合</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#插入文档" class="sidebar-link" data-v-40a3448a>插入文档</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#导入文档" class="sidebar-link" data-v-40a3448a>导入文档</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#更新文档" class="sidebar-link" data-v-40a3448a>更新文档</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#删除文档" class="sidebar-link" data-v-40a3448a>删除文档</a></li><li class="level-3" data-v-40a3448a><a href="/blog/blogs/DataBase/2020-8/MongoDB-Base.html#查询文档" class="sidebar-link" data-v-40a3448a>查询文档</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><APlayer audio="" fixed="true" theme="#b7daff" loop="loop" order="list" preload="auto" volume="0.7" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer><!----></div></div>
    <script src="/blog/assets/js/app.7616911d.js" defer></script><script src="/blog/assets/js/4.1133f83b.js" defer></script><script src="/blog/assets/js/1.f2954d1d.js" defer></script><script src="/blog/assets/js/15.7d37d9db.js" defer></script><script src="/blog/assets/js/9.cb224565.js" defer></script>
  </body>
</html>
