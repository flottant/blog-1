(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{610:function(s,a,t){"use strict";t.r(a);var e=t(3),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://gitee.com/QiJieH/blog-image-bed/raw/master/20201019005612.png",loading:"lazy"}})]),s._v(" "),t("h2",{attrs:{id:"oracle-分布式数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oracle-分布式数据库"}},[s._v("#")]),s._v(" Oracle 分布式数据库")]),s._v(" "),t("h3",{attrs:{id:"什么是分布式数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是分布式数据库"}},[s._v("#")]),s._v(" 什么是分布式数据库")]),s._v(" "),t("p",[s._v("数据物理上被存放在网络的多个节点上，逻辑上是一个整体\n"),t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://gitee.com/QiJieH/blog-image-bed/raw/master/20201015232534.png",loading:"lazy"}})]),s._v(" "),t("h3",{attrs:{id:"分布式数据库的独立性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分布式数据库的独立性"}},[s._v("#")]),s._v(" 分布式数据库的独立性")]),s._v(" "),t("p",[s._v("分布数据库的独立性指用户不必关心数据如何分割和存储，只需关心他需要什么数据")]),s._v(" "),t("h3",{attrs:{id:"oracle-分布式rdbms"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oracle-分布式rdbms"}},[s._v("#")]),s._v(" Oracle 分布式RDBMS")]),s._v(" "),t("p",[s._v("本地操作")]),s._v(" "),t("div",{staticClass:"language-SQL extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("sqlplus scott"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tiger"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@localhost")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1521")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("orcl\n")])])]),t("p",[s._v("远程操作")]),s._v(" "),t("div",{staticClass:"language-SQL extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("sqlplus scott"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tiger"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@192.168.1.23")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1521")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("orcl\n")])])]),t("p",[t("strong",[s._v("分布操作")])]),s._v(" "),t("ul",[t("li",[s._v("跨节点数据的创建及查询")]),s._v(" "),t("li",[s._v("跨节点数据更新")])]),s._v(" "),t("p",[t("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://gitee.com/QiJieH/blog-image-bed/raw/master/20201015233849.png",loading:"lazy"}})]),s._v(" "),t("p",[t("strong",[s._v("定义数据库链路 DBLINK")])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 创建DBLINK需要相应权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- GRANT CREATE DATABASE LINK TO scott")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" LINK remoteDB "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CONNECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" scott IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" tiger "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.25.23:1521/orcl'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("修改主机 "),t("code",[s._v("tnsnames.ora")]),s._v(" 文件以创建连接的服务名替代使用IP地址")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("REMOTEORCL =\n  (DESCRIPTION =\n      (ADDRESS_LIST =\n          (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.1.23)(PORT = 1521))\n      )\n      (CONNECT_DATA =\n          (SERVICE_NAME = orcl)\n      )\n)\n")])])]),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" LINK remoteDB "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CONNECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" scott IDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" tiger "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" remoteorcl"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])]),s._v(" "),t("p",[t("strong",[s._v("通过链路查询远端数据库")])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("div",{staticClass:"highlight-lines"},[t("br"),t("div",{staticClass:"highlighted"},[s._v(" ")]),t("br"),t("br")]),t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" ename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("dname\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" dept"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("emp"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@remoteDB")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("depton "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dept"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("depton"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[t("strong",[s._v("使用同义词替换远端数据库")])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" SYNONYM remoteemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@remoteDB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 使用同义词查询")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" ename"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("dname\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" dept"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("remoteemp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" remoteemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("depton "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dept"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("depton"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("使用同义词替换远端表名后，上述SQL语句已经与本地SQL语句无异，但是其实际上是访问的远端数据库数据，这样就达到了对用户欺骗，造成数据在本机上的效果。")]),s._v(" "),t("p",[t("strong",[s._v("建立远程表的本地视图")])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VIEW")]),s._v(" allemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" emo\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNION")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" remoteemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[t("strong",[s._v("分布式数据库的其他操作")]),s._v("\n插入操作：")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" remoteemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("数据复制：")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" emp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" remoteemp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[t("strong",[s._v("分布式数据库的跨节点更新")])]),s._v(" "),t("ul",[t("li",[s._v("快照\n定义快照维护关系表的异步副本，用于主表修改少，但频繁查询的表")])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SNAPSHOT")]),s._v(" emp\n    REFRESH "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("START")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" sysdba\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("NEXT")]),s._v(" next_day"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sysdba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Monday'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@maindb")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 注意：快照是定义在备份端，这里的连接应该是客机连接主机的链路")]),s._v("\n")])])]),t("ul",[t("li",[s._v("触发器\n在主机上创建触发器，实现数据的同步更新")])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("OR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("REPLACE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TRIGGER")]),s._v(" update_emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AFTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR EACH ROW")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BEGIN")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" remoteemp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" :new"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sal\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empno "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" :new"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empno"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("END")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);